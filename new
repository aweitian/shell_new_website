<?php$git_enable = true;$ip = shell_exec("curl -s ip.cip.cc");$ip = str_replace("\n", "", $ip);$port = 50077;$repository_dir = "/home/git/repository";$web_root_dir = "/home/git/www";$nginx_hosts_dir = "/etc/nginx/conf.d";$htdocs = "public";$rewrite = true;$workspace_dir = __DIR__;if (count($argv) !== 2 ){	print "php new www.aaa.com|m.aaa.com\n--not start with www,auto prepend it.\n";	if($git_enable)print "ip=$ip\n";	if($git_enable)print "port=$port\n";	if($git_enable)print "repository_dir=$repository_dir\n";	print "web_root_dir=$web_root_dir\n";	print "nginx_hosts_dir=$nginx_hosts_dir\n";	print "htdocs=$htdocs\n";	print "rewrite=$rewrite\n";	exit;}$domain = $argv[1];$d = explode( "." ,  $domain);if (count($d) == 2){	$host = "www." . $domain . " " . $domain;	}else if(count($d) == 3){	$host = $domain;	}else{	print "invalid domain\n";	exit;	}$root = $web_root_dir . '/' . $domain;$public_dir = $root . '/' . $htdocs;$exe = str_replace('.','-',$domain);$nginx_conf_dst = $nginx_hosts_dir . DIRECTORY_SEPARATOR . "$domain.conf";$nginx_conf_src = $workspace_dir . DIRECTORY_SEPARATOR . "tmp" . DIRECTORY_SEPARATOR . "$domain.conf";$config = array(	"{{repository_dir}}" => $repository_dir,	"{{web_root_dir}}" => $web_root_dir,	"{{nginx_hosts_dir}}" => $nginx_hosts_dir,	"{{root}}" => $root,    "{{host}}" => $host,	"{{exe}}" => $exe,	"{{ip}}" => $ip,	"{{port}}" => $port,	"{{domain}}" => $domain,	"{{public_dir}}" => $public_dir,	"{{rewrite}}" => $rewrite ? file_get_contents("tpl/nginx_rewrite.tpl") : "",	"{{nginx_conf_dst}}" => "$nginx_conf_dst",	"{{nginx_conf_src}}" => "$nginx_conf_src",);file_put_contents("tmp/$domain.conf",strtr(file_get_contents("tpl/nginx.tpl"),$config));file_put_contents("tmp/hook",strtr(file_get_contents("tpl/sync.tpl"),$config));file_put_contents("tmp/run",str_replace("\r","",strtr(file_get_contents("tpl/cmd.tpl"),$config)));echo file_get_contents("tmp/run");